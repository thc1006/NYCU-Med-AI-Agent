openapi: 3.0.0
info:
  title: å°ç£é†«ç™‚ AI åŠ©ç† API
  description: |
    å°ˆç‚ºå°ç£é†«ç™‚ç’°å¢ƒè¨­è¨ˆçš„ AI åŠ©ç†ç³»çµ±ï¼Œæä¾›ç—‡ç‹€åˆ†æã€é†«é™¢æœå°‹èˆ‡ç·Šæ€¥é†«ç™‚æŒ‡å¼•æœå‹™ã€‚

    ## ä¸»è¦åŠŸèƒ½

    - **ç—‡ç‹€åˆ†ç´š (Triage)**: åŸºæ–¼æè¿°çš„ç—‡ç‹€é€²è¡Œæ™ºèƒ½åˆ†ç´šï¼Œæä¾›å°±é†«å»ºè­°
    - **é†«é™¢æœå°‹**: æ ¹æ“šä½ç½®æœå°‹å°±è¿‘é†«ç™‚é™¢æ‰€ï¼Œæ”¯æ´åº§æ¨™ã€åœ°å€æˆ–IPå®šä½
    - **ç·Šæ€¥é†«ç™‚æŒ‡å¼•**: æä¾›å°ç£ç·Šæ€¥è¯çµ¡é›»è©±èˆ‡æ€¥æ•‘è³‡è¨Š
    - **å¥åº·è³‡è¨Š**: æä¾›å¥åº·æ•™è‚²è³‡æºèˆ‡ç–«è‹—æ¥ç¨®è³‡è¨Š

    ## é‡è¦è²æ˜

    âš ï¸ **é†«ç™‚å…è²¬è²æ˜**: æœ¬æœå‹™åƒ…ä¾›åƒè€ƒï¼Œä¸èƒ½å–ä»£å°ˆæ¥­é†«ç™‚è¨ºæ–·ã€‚å¦‚æœ‰ç·Šæ€¥ç‹€æ³ï¼Œè«‹ç«‹å³æ’¥æ‰“119ã€‚

    ğŸ”’ **éš±ç§ä¿è­·**: æœ¬æœå‹™éµå¾ªå°ç£å€‹äººè³‡æ–™ä¿è­·æ³•(PDPA)ï¼Œä¸æ”¶é›†æˆ–å„²å­˜å€‹äººé†«ç™‚è³‡æ–™ã€‚

    ## ç·Šæ€¥è¯çµ¡é›»è©±

    - **119**: æ¶ˆé˜²æ•‘è­·å°ˆç·š
    - **110**: è­¦å¯Ÿå ±æ¡ˆå°ˆç·š
    - **112**: æ‰‹æ©Ÿç·Šæ€¥æ’¥è™Ÿ
    - **113**: å©¦å¹¼ä¿è­·å°ˆç·š

    ## API ä½¿ç”¨è¦ç¯„

    - æ‰€æœ‰APIå›æ‡‰å‡åŒ…å«é†«ç™‚å…è²¬è²æ˜
    - ç´…æ——ç—‡ç‹€å°‡è‡ªå‹•è§¸ç™¼ç·Šæ€¥è­¦å‘Š
    - ä½ç½®è³‡è¨Šåƒ…ç”¨æ–¼æœå°‹ï¼Œä¸æœƒè¢«å„²å­˜
    - ç¬¦åˆå°ç£PDPAå€‹è³‡ä¿è­·è¦ç¯„
  version: "1.0.0"
  contact:
    name: Taiwan Medical AI Assistant Support
    email: support@taiwan-med-ai.tw
  license:
    name: MIT License
    url: https://opensource.org/licenses/MIT
  termsOfService: /terms

servers:
  - url: https://api.taiwan-med-ai.tw
    description: æ­£å¼ç’°å¢ƒ
  - url: https://staging-api.taiwan-med-ai.tw
    description: æ¸¬è©¦ç’°å¢ƒ
  - url: http://localhost:8000
    description: é–‹ç™¼ç’°å¢ƒ

tags:
  - name: ç—‡ç‹€åˆ†ç´š
    description: ç—‡ç‹€è©•ä¼°èˆ‡åˆ†ç´šæœå‹™
  - name: é†«é™¢æœå°‹
    description: å°±è¿‘é†«ç™‚é™¢æ‰€æœå°‹æœå‹™
  - name: å…ƒæ•¸æ“š
    description: æ€¥æ•‘ç†±ç·šèˆ‡ç³»çµ±è³‡è¨Š
  - name: å¥åº·è³‡è¨Š
    description: å¥åº·æ•™è‚²èˆ‡ç–«è‹—è³‡è¨Š
  - name: ç³»çµ±ç›£æ§
    description: ç³»çµ±å¥åº·æª¢æŸ¥èˆ‡ç›£æ§

paths:
  # ========== ç—‡ç‹€åˆ†ç´š API ==========
  /v1/triage:
    post:
      tags: [ç—‡ç‹€åˆ†ç´š]
      summary: ç—‡ç‹€è©•ä¼°èˆ‡åˆ†ç´š
      description: |
        æ ¹æ“šç—‡ç‹€æè¿°æä¾›æ™ºèƒ½åˆ†ç´šå»ºè­°ã€å°±é†«æŒ‡å¼•èˆ‡æ€¥æ•‘æé†’ã€‚

        ### åˆ†ç´šæ¨™æº–
        - **emergency**: ç·Šæ€¥ç‹€æ³ï¼Œç«‹å³æ’¥æ‰“119
        - **urgent**: ç·Šæ€¥ï¼Œç›¡å¿«å°±é†«
        - **outpatient**: å®‰æ’é–€è¨ºå°±é†«
        - **self-care**: å¯è‡ªæˆ‘ç…§è­·è§€å¯Ÿ

        ### å®‰å…¨æ©Ÿåˆ¶
        ç³»çµ±æœƒè‡ªå‹•æª¢æ¸¬ç´…æ——ç—‡ç‹€ï¼Œä¸¦æä¾›ç·Šæ€¥è¯çµ¡è³‡è¨Šã€‚
      operationId: assessSymptoms
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TriageRequest'
            examples:
              èƒ¸ç—›ç—‡ç‹€:
                summary: æ€¥æ€§èƒ¸ç—›è©•ä¼°
                value:
                  symptom_text: "èƒ¸éƒ¨åŠ‡ç—›ï¼Œæœ‰å£“è¿«æ„Ÿï¼Œå†’å†·æ±—"
                  age: 55
                  gender: "M"
                  duration_hours: 2
                  has_chronic_disease: true
                  medications: ["é™è¡€å£“è—¥", "é˜¿æ–¯åŒ¹éˆ"]
                  include_nearby_hospitals: true
                  location:
                    latitude: 25.0330
                    longitude: 121.5654
              ä¸€èˆ¬æ„Ÿå†’:
                summary: è¼•å¾®æ„Ÿå†’ç—‡ç‹€
                value:
                  symptom_text: "æµé¼»æ°´ã€è¼•å¾®é ­ç—›ã€ç–²å€¦"
                  age: 30
                  gender: "F"
                  duration_hours: 24
                  has_chronic_disease: false
                  medications: []
      responses:
        '200':
          description: ç—‡ç‹€è©•ä¼°å®Œæˆ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TriageResponse'
              examples:
                ç·Šæ€¥ç‹€æ³:
                  summary: ç·Šæ€¥ç—‡ç‹€è©•ä¼°çµæœ
                  value:
                    triage_level: "emergency"
                    advice: "æ‚¨çš„ç—‡ç‹€å¯èƒ½è¡¨ç¤ºæ€¥æ€§å¿ƒè‡Ÿç—…ç™¼ä½œï¼Œè«‹ç«‹å³æ’¥æ‰“119æˆ–å‰å¾€æœ€è¿‘çš„æ€¥è¨ºå®¤ã€‚"
                    detected_symptoms: ["èƒ¸ç—›", "å†·æ±—", "å£“è¿«æ„Ÿ"]
                    next_steps:
                      - "ç«‹å³æ’¥æ‰“119æ•‘è­·è»Š"
                      - "ä¿æŒå†·éœï¼Œå¹³èººä¼‘æ¯"
                      - "å¦‚æœ‰ç¡åŒ–ç”˜æ²¹è—¥ç‰©å¯èˆŒä¸‹å«æœ"
                      - "ç­‰å¾…æ•‘è­·äººå“¡åˆ°é”"
                    disclaimer: "âš ï¸ æœ¬è©•ä¼°åƒ…ä¾›åƒè€ƒï¼Œä¸èƒ½å–ä»£å°ˆæ¥­é†«ç™‚è¨ºæ–·ã€‚ç·Šæ€¥ç‹€æ³è«‹ç«‹å³æ’¥æ‰“119ã€‚"
                    emergency_numbers: ["119", "112", "110"]
                    recommended_departments: ["å¿ƒè‡Ÿå…§ç§‘", "æ€¥è¨ºç§‘"]
                    confidence_score: 0.92
                    nearby_hospitals: []
                    request_id: "triage_abc123def456"
                    timestamp: "2024-01-01T12:00:00Z"
                    locale: "zh-TW"
                è¼•å¾®ç—‡ç‹€:
                  summary: è¼•å¾®ç—‡ç‹€è©•ä¼°çµæœ
                  value:
                    triage_level: "self-care"
                    advice: "æ‚¨çš„ç—‡ç‹€çœ‹èµ·ä¾†åƒæ˜¯ä¸€èˆ¬æ„Ÿå†’ï¼Œå»ºè­°å¤šä¼‘æ¯ã€å¤šå–æ°´ï¼Œä¸¦è§€å¯Ÿç—‡ç‹€è®ŠåŒ–ã€‚"
                    detected_symptoms: ["æµé¼»æ°´", "é ­ç—›", "ç–²å€¦"]
                    next_steps:
                      - "å……åˆ†ä¼‘æ¯"
                      - "å¤šå–æº«é–‹æ°´"
                      - "æ¸…æ·¡é£²é£Ÿ"
                      - "è§€å¯Ÿç—‡ç‹€è®ŠåŒ–"
                      - "å¦‚ç—‡ç‹€æŒçºŒ3å¤©ä»¥ä¸Šè«‹å°±é†«"
                    disclaimer: "âš ï¸ æœ¬è©•ä¼°åƒ…ä¾›åƒè€ƒï¼Œå¦‚ç—‡ç‹€æŒçºŒæˆ–æƒ¡åŒ–è«‹å°±é†«ã€‚"
                    emergency_numbers: []
                    recommended_departments: ["å®¶é†«ç§‘"]
                    confidence_score: 0.78
                    request_id: "triage_xyz789abc123"
                    timestamp: "2024-01-01T12:00:00Z"
                    locale: "zh-TW"
        '422':
          description: è¼¸å…¥è³‡æ–™é©—è­‰éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '500':
          description: æœå‹™å™¨å…§éƒ¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /v1/triage/quick:
    post:
      tags: [ç—‡ç‹€åˆ†ç´š]
      summary: å¿«é€Ÿç—‡ç‹€è©•ä¼°
      description: åƒ…æä¾›ç—‡ç‹€æ–‡å­—çš„å¿«é€Ÿè©•ä¼°ï¼Œé©ç”¨æ–¼ç°¡å–®æŸ¥è©¢å ´æ™¯ã€‚
      operationId: quickAssessment
      parameters:
        - name: symptom_text
          in: query
          required: true
          description: ç—‡ç‹€æè¿°
          schema:
            type: string
            minLength: 1
            maxLength: 500
          example: "é ­ç—›ã€ç™¼ç‡’38åº¦"
      responses:
        '200':
          description: å¿«é€Ÿè©•ä¼°å®Œæˆ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuickAssessmentResponse'

  # ========== é†«é™¢æœå°‹ API ==========
  /v1/hospitals/nearby:
    get:
      tags: [é†«é™¢æœå°‹]
      summary: æœå°‹å°±è¿‘é†«ç™‚é™¢æ‰€
      description: |
        æ ¹æ“šåº§æ¨™ã€åœ°å€æˆ–IPä½ç½®æœå°‹é™„è¿‘çš„é†«é™¢ï¼ŒåŒ…å«å¥ä¿ç‰¹ç´„è³‡è¨Šã€‚

        ### å®šä½æ–¹å¼å„ªå…ˆç´š
        1. **åº§æ¨™å®šä½** (latitude + longitude) - æœ€ç²¾ç¢º
        2. **åœ°å€å®šä½** (address) - éœ€è¦geocoding
        3. **IPå®šä½** (use_ip=true) - èª¤å·®è¼ƒå¤§

        ### ç‰¹è‰²åŠŸèƒ½
        - æ”¯æ´ç—‡ç‹€ç›¸é—œçš„ç·Šæ€¥é†«é™¢å„ªå…ˆæ’åº
        - æ•´åˆå¥ä¿ç‰¹ç´„é™¢æ‰€è³‡è¨Š
        - è‡ªå‹•èª¿æ•´æœå°‹ç¯„åœï¼ˆç·Šæ€¥ç‹€æ³é™åˆ¶3å…¬é‡Œå…§ï¼‰
      operationId: searchNearbyHospitals
      parameters:
        - name: latitude
          in: query
          description: ç·¯åº¦ï¼ˆå„ªå…ˆç´šæœ€é«˜ï¼‰
          schema:
            type: number
            format: double
            minimum: -90
            maximum: 90
          example: 25.0330
        - name: longitude
          in: query
          description: ç¶“åº¦ï¼ˆèˆ‡ç·¯åº¦ä¸€èµ·ä½¿ç”¨ï¼‰
          schema:
            type: number
            format: double
            minimum: -180
            maximum: 180
          example: 121.5654
        - name: address
          in: query
          description: å°ç£åœ°å€å­—ä¸²ï¼ˆéœ€è¦geocodingï¼‰
          schema:
            type: string
            maxLength: 200
          example: "å°åŒ—å¸‚å¤§å®‰å€å¿ å­æ±è·¯å››æ®µ1è™Ÿ"
        - name: use_ip
          in: query
          description: ä½¿ç”¨IPå®šä½ï¼ˆæœ€ä½å„ªå…ˆç´šï¼‰
          schema:
            type: boolean
            default: false
        - name: radius
          in: query
          description: æœå°‹åŠå¾‘ï¼ˆå…¬å°ºï¼‰
          schema:
            type: integer
            minimum: 100
            maximum: 50000
            default: 3000
        - name: max_results
          in: query
          description: æœ€å¤§çµæœæ•¸é‡
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 20
        - name: include_nhia
          in: query
          description: æ˜¯å¦åŒ…å«å¥ä¿ç‰¹ç´„è³‡è¨Š
          schema:
            type: boolean
            default: true
        - name: symptoms
          in: query
          description: ç—‡ç‹€æè¿°åˆ—è¡¨ï¼ˆç”¨æ–¼ç·Šæ€¥é†«é™¢å„ªå…ˆæ’åºï¼‰
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
          example: ["èƒ¸ç—›", "å‘¼å¸å›°é›£"]
      responses:
        '200':
          description: é†«é™¢æœå°‹æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HospitalSearchResponse'
              examples:
                å°åŒ—å¸‚é†«é™¢æœå°‹:
                  summary: å°åŒ—å¸‚ä¸­å¿ƒé†«é™¢æœå°‹çµæœ
                  value:
                    results:
                      - id: "ChIJN1t_tDeuEmsRUsoyG83frY4"
                        name: "å°å¤§é†«é™¢"
                        address: "å°åŒ—å¸‚ä¸­æ­£å€ä¸­å±±å—è·¯7è™Ÿ"
                        latitude: 25.0408
                        longitude: 121.5215
                        distance_meters: 850
                        phone: "02-23123456"
                        rating: 4.2
                        is_open_now: true
                        business_status: "OPERATIONAL"
                        nhia_info:
                          is_contracted: true
                          specialties: ["å…§ç§‘", "å¤–ç§‘", "æ€¥è¨ºç§‘"]
                          level: "é†«å­¸ä¸­å¿ƒ"
                    search_center:
                      latitude: 25.0330
                      longitude: 121.5654
                    search_radius: 3000
                    total_count: 15
                    locale: "zh-TW"
                    emergency_numbers: ["119", "110", "112"]
                    emergency_reminder: "ç·Šæ€¥æƒ…æ³è«‹ç«‹å³æ’¥æ‰“ 119ï¼ˆæ¶ˆé˜²æ•‘è­·ï¼‰æˆ– 110ï¼ˆè­¦å¯Ÿï¼‰ã€‚æœ¬æœå°‹çµæœåƒ…ä¾›åƒè€ƒï¼Œä¸å¯å–ä»£å°ˆæ¥­é†«ç™‚åˆ¤æ–·ã€‚"
                    search_method: "coordinates"
                    medical_disclaimer: "âš ï¸ æœ¬æœå‹™åƒ…ä¾›åƒè€ƒï¼Œä¸èƒ½å–ä»£å°ˆæ¥­é†«ç™‚è¨ºæ–·ã€‚å¦‚æœ‰ç·Šæ€¥ç‹€æ³ï¼Œè«‹ç«‹å³æ’¥æ‰“119ã€‚"
                    privacy_notice: "æ‚¨çš„ä½ç½®è³‡è¨Šåƒ…ç”¨æ–¼æœå°‹é™„è¿‘é†«é™¢ï¼Œä¸æœƒè¢«å„²å­˜æˆ–åˆ†äº«ã€‚"
        '400':
          description: è«‹æ±‚åƒæ•¸éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                å®šä½å¤±æ•—:
                  summary: ç„¡æ³•ç¢ºå®šä½ç½®
                  value:
                    detail: "Must provide either (latitude+longitude), address, or set use_ip=true"
                åº§æ¨™ç¯„åœéŒ¯èª¤:
                  summary: åº§æ¨™è¶…å‡ºæœ‰æ•ˆç¯„åœ
                  value:
                    detail: "Invalid latitude. Must be between -90 and 90."

  # ========== å…ƒæ•¸æ“š API ==========
  /v1/meta/emergency:
    get:
      tags: [å…ƒæ•¸æ“š]
      summary: å–å¾—å°ç£æ€¥æ•‘ç†±ç·šè³‡è¨Š
      description: æä¾›å°ç£åœ°å€å®˜æ–¹èªå¯çš„æ€¥æ•‘èˆ‡ç·Šæ€¥è¯çµ¡é›»è©±è™Ÿç¢¼ï¼ŒåŒ…å«ä½¿ç”¨èªªæ˜ã€é©ç”¨ç¯„åœå’Œæ³¨æ„äº‹é …ã€‚
      operationId: getEmergencyNumbers
      responses:
        '200':
          description: æ€¥æ•‘ç†±ç·šè³‡è¨Š
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmergencyResponse'

  # ========== å¥åº·è³‡è¨Š API ==========
  /v1/health-info/topics:
    get:
      tags: [å¥åº·è³‡è¨Š]
      summary: å–å¾—å¥åº·æ•™è‚²ä¸»é¡Œæ¸…å–®
      description: æä¾›å°ç£å¥åº·æ•™è‚²ä¸»é¡Œè³‡è¨Šï¼ŒåŒ…å«å°±é†«æµç¨‹ã€æ€¥è¨ºæŒ‡å¼•ç­‰ä¸»é¡Œã€‚
      operationId: getHealthTopics
      responses:
        '200':
          description: å¥åº·ä¸»é¡Œæ¸…å–®
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthTopicsResponse'

  # ========== ç³»çµ±ç›£æ§ API ==========
  /healthz:
    get:
      tags: [ç³»çµ±ç›£æ§]
      summary: å¥åº·æª¢æŸ¥ç«¯é»
      description: æª¢æŸ¥ API æœå‹™æ˜¯å¦æ­£å¸¸é‹è¡Œ
      operationId: healthCheck
      responses:
        '200':
          description: æœå‹™æ­£å¸¸
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"

  /v1/monitoring/health:
    get:
      tags: [ç³»çµ±ç›£æ§]
      summary: è©³ç´°å¥åº·æª¢æŸ¥
      description: æä¾›è©³ç´°çš„ç³»çµ±å¥åº·ç‹€æ…‹ï¼ŒåŒ…å«å¤–éƒ¨æœå‹™é€£ç·šç‹€æ…‹
      operationId: detailedHealthCheck
      responses:
        '200':
          description: è©³ç´°å¥åº·ç‹€æ…‹
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DetailedHealthResponse'

components:
  schemas:
    # ========== è«‹æ±‚æ¨¡å‹ ==========
    TriageRequest:
      type: object
      required:
        - symptom_text
      properties:
        symptom_text:
          type: string
          description: ç—‡ç‹€æè¿°
          minLength: 1
          maxLength: 1000
          example: "èƒ¸éƒ¨åŠ‡ç—›ï¼Œå‘¼å¸å›°é›£ï¼Œå†’å†·æ±—"
        age:
          type: integer
          description: å¹´é½¡
          minimum: 0
          maximum: 150
          example: 45
        gender:
          type: string
          description: æ€§åˆ¥
          enum: ["M", "F", "O"]
          example: "M"
        duration_hours:
          type: integer
          description: ç—‡ç‹€æŒçºŒæ™‚é–“ï¼ˆå°æ™‚ï¼‰
          minimum: 0
          maximum: 8760
          example: 2
        has_chronic_disease:
          type: boolean
          description: æ˜¯å¦æœ‰æ…¢æ€§ç–¾ç—…
          default: false
        medications:
          type: array
          description: ç›®å‰æœç”¨è—¥ç‰©
          items:
            type: string
          example: ["é™è¡€å£“è—¥", "é˜¿æ–¯åŒ¹éˆ"]
        include_nearby_hospitals:
          type: boolean
          description: æ˜¯å¦åŒ…å«é™„è¿‘é†«é™¢è³‡è¨Š
          default: false
        location:
          type: object
          description: ä½ç½®è³‡è¨Šï¼ˆæœå°‹é™„è¿‘é†«é™¢æ™‚ä½¿ç”¨ï¼‰
          properties:
            latitude:
              type: number
              format: double
              minimum: -90
              maximum: 90
            longitude:
              type: number
              format: double
              minimum: -180
              maximum: 180
          example:
            latitude: 25.0330
            longitude: 121.5654

    # ========== å›æ‡‰æ¨¡å‹ ==========
    TriageResponse:
      type: object
      required:
        - triage_level
        - advice
        - detected_symptoms
        - next_steps
        - disclaimer
        - request_id
        - timestamp
        - locale
      properties:
        triage_level:
          type: string
          description: åˆ†ç´šçµæœ
          enum: ["emergency", "urgent", "outpatient", "self-care"]
          example: "emergency"
        advice:
          type: string
          description: å°±é†«å»ºè­°
          example: "æ‚¨çš„ç—‡ç‹€å¯èƒ½è¡¨ç¤ºæ€¥æ€§å¿ƒè‡Ÿç—…ç™¼ä½œï¼Œè«‹ç«‹å³æ’¥æ‰“119æˆ–å‰å¾€æœ€è¿‘çš„æ€¥è¨ºå®¤ã€‚"
        detected_symptoms:
          type: array
          description: æª¢æ¸¬åˆ°çš„ç—‡ç‹€
          items:
            type: string
          example: ["èƒ¸ç—›", "å†·æ±—", "å‘¼å¸å›°é›£"]
        next_steps:
          type: array
          description: ä¸‹ä¸€æ­¥è¡Œå‹•å»ºè­°
          items:
            type: string
          example: ["ç«‹å³æ’¥æ‰“119æ•‘è­·è»Š", "ä¿æŒå†·éœï¼Œå¹³èººä¼‘æ¯", "ç­‰å¾…æ•‘è­·äººå“¡åˆ°é”"]
        disclaimer:
          type: string
          description: é†«ç™‚å…è²¬è²æ˜
          example: "âš ï¸ æœ¬è©•ä¼°åƒ…ä¾›åƒè€ƒï¼Œä¸èƒ½å–ä»£å°ˆæ¥­é†«ç™‚è¨ºæ–·ã€‚ç·Šæ€¥ç‹€æ³è«‹ç«‹å³æ’¥æ‰“119ã€‚"
        emergency_numbers:
          type: array
          description: ç·Šæ€¥è¯çµ¡é›»è©±
          items:
            type: string
          example: ["119", "112", "110"]
        recommended_departments:
          type: array
          description: æ¨è–¦å°±è¨ºç§‘åˆ¥
          items:
            type: string
          example: ["å¿ƒè‡Ÿå…§ç§‘", "æ€¥è¨ºç§‘"]
        estimated_wait_time:
          type: string
          description: é ä¼°ç­‰å€™æ™‚é–“
          example: "ç«‹å³è™•ç†"
        confidence_score:
          type: number
          format: double
          description: ä¿¡å¿ƒåˆ†æ•¸
          minimum: 0
          maximum: 1
          example: 0.92
        nearby_hospitals:
          type: array
          description: é™„è¿‘é†«é™¢ï¼ˆå¦‚æœ‰è«‹æ±‚ï¼‰
          items:
            $ref: '#/components/schemas/HospitalInfo'
        request_id:
          type: string
          description: è«‹æ±‚å”¯ä¸€è­˜åˆ¥ç¢¼
          example: "triage_abc123def456"
        timestamp:
          type: string
          format: date-time
          description: è©•ä¼°æ™‚é–“æˆ³
          example: "2024-01-01T12:00:00Z"
        locale:
          type: string
          description: èªè¨€åœ°å€
          example: "zh-TW"

    QuickAssessmentResponse:
      type: object
      required:
        - level
        - advice
        - next_steps
        - disclaimer
        - locale
      properties:
        level:
          type: string
          description: åˆ†ç´šçµæœ
          enum: ["emergency", "urgent", "outpatient", "self-care"]
        advice:
          type: string
          description: ç°¡è¦å»ºè­°
        next_steps:
          type: array
          description: å‰3å€‹é—œéµæ­¥é©Ÿ
          items:
            type: string
          maxItems: 3
        emergency_numbers:
          type: array
          description: ç·Šæ€¥è¯çµ¡é›»è©±ï¼ˆåƒ…ç·Šæ€¥ç‹€æ³ï¼‰
          items:
            type: string
        disclaimer:
          type: string
          description: ç°¡åŒ–å…è²¬è²æ˜
          example: "æœ¬è©•ä¼°åƒ…ä¾›åƒè€ƒï¼Œç·Šæ€¥ç‹€æ³è«‹æ’¥æ‰“119ã€‚"
        locale:
          type: string
          example: "zh-TW"

    HospitalSearchResponse:
      type: object
      required:
        - results
        - search_center
        - search_radius
        - total_count
        - locale
        - emergency_numbers
        - emergency_reminder
        - search_method
        - medical_disclaimer
        - privacy_notice
      properties:
        results:
          type: array
          description: é†«é™¢æœå°‹çµæœ
          items:
            $ref: '#/components/schemas/HospitalInfo'
        hospitals:
          type: array
          description: é†«é™¢æœå°‹çµæœï¼ˆåˆ¥åï¼‰
          items:
            $ref: '#/components/schemas/HospitalInfo'
        search_center:
          type: object
          description: æœå°‹ä¸­å¿ƒé»
          properties:
            latitude:
              type: number
              format: double
            longitude:
              type: number
              format: double
        search_radius:
          type: integer
          description: æœå°‹åŠå¾‘ï¼ˆå…¬å°ºï¼‰
        total_count:
          type: integer
          description: ç¸½çµæœæ•¸é‡
        locale:
          type: string
          example: "zh-TW"
        emergency_numbers:
          type: array
          description: ç·Šæ€¥è¯çµ¡é›»è©±
          items:
            type: string
        emergency_reminder:
          type: string
          description: ç·Šæ€¥æé†’è¨Šæ¯
        search_method:
          type: string
          description: æœå°‹æ–¹å¼
          enum: ["coordinates", "address", "ip"]
        emergency_info:
          $ref: '#/components/schemas/EmergencyInfo'
        medical_disclaimer:
          type: string
          description: é†«ç™‚å…è²¬è²æ˜
        privacy_notice:
          type: string
          description: éš±ç§ä¿è­·è²æ˜

    HospitalInfo:
      type: object
      required:
        - id
        - name
        - address
        - latitude
        - longitude
        - distance_meters
      properties:
        id:
          type: string
          description: é†«é™¢å”¯ä¸€è­˜åˆ¥ç¢¼
          example: "ChIJN1t_tDeuEmsRUsoyG83frY4"
        name:
          type: string
          description: é†«é™¢åç¨±
          example: "å°å¤§é†«é™¢"
        address:
          type: string
          description: é†«é™¢åœ°å€
          example: "å°åŒ—å¸‚ä¸­æ­£å€ä¸­å±±å—è·¯7è™Ÿ"
        latitude:
          type: number
          format: double
          description: ç·¯åº¦
        longitude:
          type: number
          format: double
          description: ç¶“åº¦
        distance_meters:
          type: integer
          description: è·é›¢ï¼ˆå…¬å°ºï¼‰
          example: 850
        phone:
          type: string
          description: è¯çµ¡é›»è©±
          example: "02-23123456"
        rating:
          type: number
          format: double
          description: Google è©•åˆ†
          minimum: 1
          maximum: 5
          example: 4.2
        is_open_now:
          type: boolean
          description: ç›®å‰æ˜¯å¦ç‡Ÿæ¥­
        opening_hours:
          type: array
          description: ç‡Ÿæ¥­æ™‚é–“
          items:
            type: string
        business_status:
          type: string
          description: ç‡Ÿæ¥­ç‹€æ…‹
          enum: ["OPERATIONAL", "CLOSED_TEMPORARILY", "CLOSED_PERMANENTLY", "UNKNOWN"]
        nhia_info:
          $ref: '#/components/schemas/NHIAInfo'

    NHIAInfo:
      type: object
      description: å¥ä¿ç‰¹ç´„è³‡è¨Š
      properties:
        is_contracted:
          type: boolean
          description: æ˜¯å¦ç‚ºå¥ä¿ç‰¹ç´„é™¢æ‰€
        specialties:
          type: array
          description: å°ˆç§‘é …ç›®
          items:
            type: string
        level:
          type: string
          description: é†«é™¢å±¤ç´š
          enum: ["é†«å­¸ä¸­å¿ƒ", "å€åŸŸé†«é™¢", "åœ°å€é†«é™¢", "è¨ºæ‰€"]
        emergency_services:
          type: boolean
          description: æ˜¯å¦æä¾›æ€¥è¨ºæœå‹™

    EmergencyInfo:
      type: object
      required:
        - is_emergency
        - emergency_message
      properties:
        is_emergency:
          type: boolean
          description: æ˜¯å¦ç‚ºç·Šæ€¥ç‹€æ³
        detected_symptoms:
          type: array
          description: åµæ¸¬åˆ°çš„ç—‡ç‹€
          items:
            type: string
        emergency_numbers:
          type: object
          description: ç·Šæ€¥è¯çµ¡è™Ÿç¢¼
          additionalProperties:
            type: string
        emergency_message:
          type: string
          description: ç·Šæ€¥è¨Šæ¯

    EmergencyResponse:
      type: object
      required:
        - numbers
        - updated_at
        - locale
        - source
        - disclaimer
        - usage_notes
      properties:
        numbers:
          type: array
          description: æ€¥æ•‘è™Ÿç¢¼åˆ—è¡¨
          items:
            $ref: '#/components/schemas/EmergencyNumber'
        updated_at:
          type: string
          format: date-time
          description: æ›´æ–°æ™‚é–“
        locale:
          type: string
          example: "zh-TW"
        source:
          type: string
          description: è³‡æ–™ä¾†æº
        disclaimer:
          type: string
          description: å…è²¬è²æ˜
        usage_notes:
          type: array
          description: ä½¿ç”¨æ³¨æ„äº‹é …
          items:
            type: string

    EmergencyNumber:
      type: object
      required:
        - code
        - description
        - category
      properties:
        code:
          type: string
          description: æ€¥æ•‘è™Ÿç¢¼
          example: "119"
        description:
          type: string
          description: è™Ÿç¢¼èªªæ˜
          example: "æ¶ˆé˜²æ•‘è­·å°ˆç·š"
        category:
          type: string
          description: åˆ†é¡
          example: "ç·Šæ€¥æ•‘è­·"
        available:
          type: string
          description: æœå‹™æ™‚é–“
          default: "24å°æ™‚"
        coverage:
          type: string
          description: æœå‹™ç¯„åœ
          default: "å…¨å°ç£"

    HealthTopicsResponse:
      type: object
      required:
        - topics
        - total_count
        - locale
      properties:
        topics:
          type: array
          description: å¥åº·ä¸»é¡Œåˆ—è¡¨
          items:
            type: object
            properties:
              id:
                type: string
              title:
                type: string
              summary:
                type: string
              category:
                type: string
        total_count:
          type: integer
          description: ä¸»é¡Œç¸½æ•¸
        locale:
          type: string
          example: "zh-TW"

    DetailedHealthResponse:
      type: object
      required:
        - status
        - timestamp
        - checks
      properties:
        status:
          type: string
          description: æ•´é«”ç‹€æ…‹
          enum: ["healthy", "degraded", "unhealthy"]
        timestamp:
          type: string
          format: date-time
          description: æª¢æŸ¥æ™‚é–“
        checks:
          type: object
          description: å„é …æª¢æŸ¥çµæœ
          additionalProperties:
            type: object
            properties:
              status:
                type: string
                enum: ["pass", "fail", "warn"]
              message:
                type: string
              response_time_ms:
                type: number
        overall_status:
          type: string
          description: æ•´é«”ç‹€æ…‹æè¿°
        system_info:
          type: object
          description: ç³»çµ±è³‡è¨Š
          properties:
            version:
              type: string
            environment:
              type: string
            uptime_seconds:
              type: number

    # ========== éŒ¯èª¤æ¨¡å‹ ==========
    Error:
      type: object
      required:
        - detail
      properties:
        detail:
          type: string
          description: éŒ¯èª¤è©³æƒ…
          example: "Invalid request parameters"
        error_code:
          type: string
          description: éŒ¯èª¤ä»£ç¢¼
        timestamp:
          type: string
          format: date-time
          description: éŒ¯èª¤ç™¼ç”Ÿæ™‚é–“

    ValidationError:
      type: object
      required:
        - detail
      properties:
        detail:
          oneOf:
            - type: string
            - type: array
              items:
                type: object
                properties:
                  loc:
                    type: array
                    items:
                      anyOf:
                        - type: string
                        - type: integer
                  msg:
                    type: string
                  type:
                    type: string

  # ========== å®‰å…¨æ€§ ==========
  securitySchemes:
    RateLimiting:
      type: apiKey
      description: |
        API é€Ÿç‡é™åˆ¶æ©Ÿåˆ¶
        - é è¨­é™åˆ¶ï¼šæ¯åˆ†é˜100æ¬¡è«‹æ±‚
        - ç·Šæ€¥è©•ä¼°ï¼šæ¯åˆ†é˜20æ¬¡è«‹æ±‚
        - è¶…å‡ºé™åˆ¶å°‡å›å‚³429ç‹€æ…‹ç¢¼
      name: X-RateLimit-Limit
      in: header

  # ========== å›æ‡‰æ¨™é ­ ==========
  headers:
    X-Request-Id:
      description: è«‹æ±‚å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç”¨æ–¼è¿½è¹¤å’Œé™¤éŒ¯
      schema:
        type: string
        example: "req_abc123def456"
    X-RateLimit-Limit:
      description: é€Ÿç‡é™åˆ¶ä¸Šé™
      schema:
        type: integer
        example: 100
    X-RateLimit-Remaining:
      description: å‰©é¤˜è«‹æ±‚æ¬¡æ•¸
      schema:
        type: integer
        example: 95
    X-Response-Time:
      description: å›æ‡‰æ™‚é–“ï¼ˆæ¯«ç§’ï¼‰
      schema:
        type: number
        example: 250.5

# ========== å…¨åŸŸå®‰å…¨æ€§ ==========
security:
  - RateLimiting: []

# ========== å¤–éƒ¨æ–‡ä»¶ ==========
externalDocs:
  description: å°ç£é†«ç™‚ AI åŠ©ç†å®Œæ•´æ–‡ä»¶
  url: https://docs.taiwan-med-ai.tw