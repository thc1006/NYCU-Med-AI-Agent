{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thc1006\\\\Desktop\\\\dev\\\\NYCU-Med-AI-Agent\\\\frontend\\\\src\\\\pages\\\\HomePage.tsx\",\n  _s = $RefreshSig$();\n/**\n * 首頁元件 - 症狀評估主介面\n */\n\nimport React, { useCallback, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport toast from 'react-hot-toast';\nimport Header from '../components/Layout/Header';\nimport SymptomForm from '../components/SymptomForm/SymptomForm';\nimport TriageResult from '../components/TriageResult/TriageResult';\nimport HospitalList from '../components/HospitalList/HospitalList';\nimport { useGeolocation } from '../hooks/useGeolocation';\nimport { useTriageResult, useHospitals, useLoadingState, useSymptomHistory, useLocation } from '../stores/useAppStore';\nimport { triageApi, hospitalApi, emergencyApi, locationApi } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst HomePage = () => {\n  _s();\n  const navigate = useNavigate();\n\n  // 狀態管理\n  const {\n    latestResult,\n    setLatestResult,\n    clearLatestResult\n  } = useTriageResult();\n  const {\n    nearbyHospitals,\n    setNearbyHospitals,\n    clearNearbyHospitals\n  } = useHospitals();\n  const {\n    isLoading,\n    error,\n    setLoading,\n    setError\n  } = useLoadingState();\n  const {\n    addSymptomHistory\n  } = useSymptomHistory();\n  const {\n    userLocation\n  } = useLocation();\n\n  // 地理位置\n  const {\n    getCurrentLocation,\n    loading: locationLoading,\n    error: locationError\n  } = useGeolocation({\n    onSuccess: location => {\n      console.log('Location obtained:', location);\n    },\n    onError: error => {\n      console.warn('Location error:', error);\n    }\n  });\n\n  // 處理症狀評估提交\n  const handleSymptomSubmit = useCallback(async request => {\n    setLoading(true);\n    setError(null);\n    clearLatestResult();\n    clearNearbyHospitals();\n    try {\n      // 如果需要位置資訊但尚未取得，先嘗試取得位置\n      if (request.include_nearby_hospitals && !request.location && userLocation) {\n        request.location = userLocation;\n      }\n\n      // 執行症狀評估\n      const result = await triageApi.quickTriage(request);\n      setLatestResult(result);\n\n      // 加入歷史記錄\n      addSymptomHistory({\n        symptom_text: request.symptom_text,\n        triage_level: result.triage_level,\n        timestamp: new Date().toISOString(),\n        location: request.location\n      });\n\n      // 如果有附近醫院資料，直接設定\n      if (result.nearby_hospitals) {\n        setNearbyHospitals(result.nearby_hospitals);\n      }\n\n      // 成功提示\n      toast.success('症狀評估完成');\n\n      // 如果是緊急情況，顯示特別提醒\n      if (result.triage_level === 'emergency') {\n        toast.error('檢測到緊急狀況！請立即撥打119', {\n          duration: 10000,\n          position: 'top-center'\n        });\n      }\n    } catch (err) {\n      const message = err instanceof Error ? err.message : '評估失敗，請重試';\n      setError(message);\n      toast.error(message);\n      console.error('Triage submission error:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [setLoading, setError, clearLatestResult, clearNearbyHospitals, setLatestResult, addSymptomHistory, setNearbyHospitals, userLocation]);\n\n  // 處理尋找附近醫院\n  const handleFindHospitals = useCallback(async () => {\n    if (!userLocation) {\n      toast.error('請先允許位置存取');\n      return;\n    }\n    setLoading(true);\n    try {\n      const hospitals = await hospitalApi.searchNearby({\n        latitude: userLocation.latitude,\n        longitude: userLocation.longitude,\n        radius: 10000,\n        // 10km\n        limit: 20,\n        departments: latestResult === null || latestResult === void 0 ? void 0 : latestResult.recommended_departments\n      });\n\n      // 計算距離並排序\n      const hospitalsWithDistance = hospitals.map(hospital => ({\n        ...hospital,\n        distance: locationApi.calculateDistance(userLocation.latitude, userLocation.longitude, hospital.lat, hospital.lng)\n      })).sort((a, b) => a.distance - b.distance);\n      setNearbyHospitals(hospitalsWithDistance);\n      toast.success(`找到 ${hospitals.length} 家附近醫院`);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : '搜尋醫院失敗';\n      toast.error(message);\n      console.error('Hospital search error:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [userLocation, latestResult === null || latestResult === void 0 ? void 0 : latestResult.recommended_departments, setLoading, setNearbyHospitals]);\n\n  // 處理緊急撥號\n  const handleEmergencyCall = useCallback(number => {\n    emergencyApi.call(number);\n\n    // 記錄緊急撥號事件\n    console.log(`Emergency call initiated: ${number}`);\n    toast.success(`正在撥打 ${number}`, {\n      icon: '📞'\n    });\n  }, []);\n\n  // 處理醫院選擇\n  const handleHospitalSelect = useCallback(hospital => {\n    console.log('Hospital selected:', hospital);\n    toast.success(`已選擇：${hospital.name}`);\n  }, []);\n\n  // 處理醫院電話撥打\n  const handleHospitalCall = useCallback(phone => {\n    emergencyApi.call(phone);\n    toast.success(`正在撥打：${phone}`, {\n      icon: '📞'\n    });\n  }, []);\n\n  // 處理醫院導航\n  const handleHospitalNavigate = useCallback(hospital => {\n    const googleMapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${hospital.lat},${hospital.lng}&destination_place_id=${hospital.id}`;\n    try {\n      window.open(googleMapsUrl, '_blank');\n      toast.success(`正在開啟導航至：${hospital.name}`);\n    } catch (err) {\n      var _navigator$clipboard;\n      // 如果無法開啟，複製地址到剪貼簿\n      (_navigator$clipboard = navigator.clipboard) === null || _navigator$clipboard === void 0 ? void 0 : _navigator$clipboard.writeText(hospital.address);\n      toast.success(`地址已複製：${hospital.address}`);\n    }\n  }, []);\n\n  // 處理位置點擊\n  const handleLocationClick = useCallback(() => {\n    if (locationLoading) return;\n    getCurrentLocation();\n  }, [getCurrentLocation, locationLoading]);\n\n  // 處理歷史記錄點擊\n  const handleHistoryClick = useCallback(() => {\n    navigate('/history');\n  }, [navigate]);\n\n  // 自動取得位置（首次載入）\n  useEffect(() => {\n    if (!userLocation && !locationError) {\n      // 延遲一下再自動取得位置，避免干擾使用者\n      const timer = setTimeout(() => {\n        getCurrentLocation();\n      }, 1000);\n      return () => clearTimeout(timer);\n    }\n  }, [userLocation, locationError, getCurrentLocation]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen relative\",\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      onLocationClick: handleLocationClick,\n      onHistoryClick: handleHistoryClick\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"container-glass py-8 space-y-8 relative z-10\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"text-center space-y-4 animate-fade-in\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inline-flex items-center gap-3 glass-card rounded-2xl px-6 py-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-3 h-3 bg-medical-500 rounded-full animate-ping\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-medical-700 font-medium text-sm\",\n            children: \"AI \\u91AB\\u7642\\u52A9\\u624B\\u5DF2\\u5C31\\u7DD2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl md:text-3xl font-bold text-gray-800 animate-fade-in animate-delay-200\",\n          children: [\"\\u63CF\\u8FF0\\u60A8\\u7684\\u75C7\\u72C0\\uFF0C\", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gradient\",\n            children: \"\\u7ACB\\u5373\\u7372\\u5F97\\u667A\\u80FD\\u5206\\u7D1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 max-w-lg mx-auto leading-relaxed animate-fade-in animate-delay-300\",\n          children: \"\\u57FA\\u65BC\\u53F0\\u7063\\u91AB\\u7642\\u6A19\\u6E96\\u7684AI\\u5206\\u7D1A\\u7CFB\\u7D71\\uFF0C\\u63D0\\u4F9B\\u5373\\u6642\\u75C7\\u72C0\\u8A55\\u4F30\\u8207\\u5C31\\u91AB\\u5EFA\\u8B70\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"emergency-glass rounded-2xl p-6 animate-scale-in\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-start gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-shrink-0 w-10 h-10 bg-red-500 rounded-full flex items-center justify-center\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5 text-white\",\n              fill: \"currentColor\",\n              viewBox: \"0 0 20 20\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                fillRule: \"evenodd\",\n                d: \"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\",\n                clipRule: \"evenodd\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-semibold text-red-800 mb-1\",\n              children: \"\\u7CFB\\u7D71\\u63D0\\u793A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-700\",\n              children: error\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"animate-fade-in animate-delay-100\",\n        children: /*#__PURE__*/_jsxDEV(SymptomForm, {\n          onSubmit: handleSymptomSubmit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), latestResult && /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"animate-slide-up\",\n        children: /*#__PURE__*/_jsxDEV(TriageResult, {\n          result: latestResult,\n          onFindHospitals: handleFindHospitals,\n          onEmergencyCall: handleEmergencyCall\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 11\n      }, this), nearbyHospitals.length > 0 && /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"animate-slide-up animate-delay-200\",\n        children: /*#__PURE__*/_jsxDEV(HospitalList, {\n          hospitals: nearbyHospitals,\n          userLocation: userLocation,\n          loading: isLoading,\n          onHospitalSelect: handleHospitalSelect,\n          onCallHospital: handleHospitalCall,\n          onNavigate: handleHospitalNavigate\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 11\n      }, this), isLoading && !latestResult && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-center justify-center py-12 animate-fade-in\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"glass-card rounded-3xl p-8 text-center space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-modern mx-auto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-semibold text-gray-800\",\n              children: \"AI \\u6B63\\u5728\\u5206\\u6790\\u60A8\\u7684\\u75C7\\u72C0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-gray-600 text-sm\",\n              children: \"\\u904B\\u7528\\u6DF1\\u5EA6\\u5B78\\u7FD2\\u6A21\\u578B\\u9032\\u884C\\u91AB\\u7642\\u7D1A\\u8A55\\u4F30...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center space-x-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-2 h-2 bg-brand-400 rounded-full animate-bounce\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-2 h-2 bg-brand-400 rounded-full animate-bounce animate-delay-75\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-2 h-2 bg-brand-400 rounded-full animate-bounce animate-delay-150\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 11\n      }, this), !latestResult && !isLoading && /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"grid md:grid-cols-3 gap-6 animate-fade-in animate-delay-500\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"glass-card rounded-2xl p-6 text-center space-y-3 hover:scale-105 transition-all duration-300\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-12 h-12 bg-gradient-brand rounded-xl mx-auto flex items-center justify-center\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-6 h-6 text-white\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: \"2\",\n                d: \"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 312,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-gray-800\",\n            children: \"\\u667A\\u80FD\\u5206\\u7D1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 leading-relaxed\",\n            children: \"AI \\u5206\\u6790\\u75C7\\u72C0\\u56B4\\u91CD\\u7A0B\\u5EA6\\uFF0C\\u63D0\\u4F9B\\u6A19\\u6E96\\u5316\\u91AB\\u7642\\u5206\\u7D1A\\u5EFA\\u8B70\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"glass-card rounded-2xl p-6 text-center space-y-3 hover:scale-105 transition-all duration-300\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-12 h-12 bg-gradient-accent rounded-xl mx-auto flex items-center justify-center\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-6 h-6 text-white\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: \"2\",\n                d: \"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: \"2\",\n                d: \"M15 11a3 3 0 11-6 0 3 3 0 016 0z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-gray-800\",\n            children: \"\\u5C31\\u8FD1\\u5C31\\u91AB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 leading-relaxed\",\n            children: \"\\u5373\\u6642\\u5B9A\\u4F4D\\u9644\\u8FD1\\u91AB\\u7642\\u9662\\u6240\\uFF0C\\u63D0\\u4F9B\\u8DDD\\u96E2\\u8207\\u79D1\\u5225\\u8CC7\\u8A0A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"glass-card rounded-2xl p-6 text-center space-y-3 hover:scale-105 transition-all duration-300\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-12 h-12 bg-gradient-to-br from-medical-400 to-medical-600 rounded-xl mx-auto flex items-center justify-center\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-6 h-6 text-white\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: \"2\",\n                d: \"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-gray-800\",\n            children: \"\\u96B1\\u79C1\\u4FDD\\u8B77\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 leading-relaxed\",\n            children: \"\\u7B26\\u5408 PDPA \\u898F\\u7BC4\\uFF0C\\u4E0D\\u5132\\u5B58\\u500B\\u4EBA\\u8CC7\\u6599\\uFF0C\\u50C5\\u4F9B\\u5373\\u6642\\u8A55\\u4F30\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"safe-bottom\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 213,\n    columnNumber: 5\n  }, this);\n};\n_s(HomePage, \"5ouMNkhSrNrU4SpjMeaYw039CMA=\", false, function () {\n  return [useNavigate, useTriageResult, useHospitals, useLoadingState, useSymptomHistory, useLocation, useGeolocation];\n});\n_c = HomePage;\nexport default HomePage;\nvar _c;\n$RefreshReg$(_c, \"HomePage\");","map":{"version":3,"names":["React","useCallback","useEffect","useNavigate","toast","Header","SymptomForm","TriageResult","HospitalList","useGeolocation","useTriageResult","useHospitals","useLoadingState","useSymptomHistory","useLocation","triageApi","hospitalApi","emergencyApi","locationApi","jsxDEV","_jsxDEV","HomePage","_s","navigate","latestResult","setLatestResult","clearLatestResult","nearbyHospitals","setNearbyHospitals","clearNearbyHospitals","isLoading","error","setLoading","setError","addSymptomHistory","userLocation","getCurrentLocation","loading","locationLoading","locationError","onSuccess","location","console","log","onError","warn","handleSymptomSubmit","request","include_nearby_hospitals","result","quickTriage","symptom_text","triage_level","timestamp","Date","toISOString","nearby_hospitals","success","duration","position","err","message","Error","handleFindHospitals","hospitals","searchNearby","latitude","longitude","radius","limit","departments","recommended_departments","hospitalsWithDistance","map","hospital","distance","calculateDistance","lat","lng","sort","a","b","length","handleEmergencyCall","number","call","icon","handleHospitalSelect","name","handleHospitalCall","phone","handleHospitalNavigate","googleMapsUrl","id","window","open","_navigator$clipboard","navigator","clipboard","writeText","address","handleLocationClick","handleHistoryClick","timer","setTimeout","clearTimeout","className","children","onLocationClick","onHistoryClick","fileName","_jsxFileName","lineNumber","columnNumber","fill","viewBox","fillRule","d","clipRule","onSubmit","onFindHospitals","onEmergencyCall","onHospitalSelect","onCallHospital","onNavigate","stroke","strokeLinecap","strokeLinejoin","strokeWidth","_c","$RefreshReg$"],"sources":["C:/Users/thc1006/Desktop/dev/NYCU-Med-AI-Agent/frontend/src/pages/HomePage.tsx"],"sourcesContent":["/**\n * 首頁元件 - 症狀評估主介面\n */\n\nimport React, { useCallback, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport toast from 'react-hot-toast';\n\nimport Header from '../components/Layout/Header';\nimport SymptomForm from '../components/SymptomForm/SymptomForm';\nimport TriageResult from '../components/TriageResult/TriageResult';\nimport HospitalList from '../components/HospitalList/HospitalList';\n\nimport { useGeolocation } from '../hooks/useGeolocation';\nimport {\n  useTriageResult,\n  useHospitals,\n  useLoadingState,\n  useSymptomHistory,\n  useLocation\n} from '../stores/useAppStore';\n\nimport { triageApi, hospitalApi, emergencyApi, locationApi } from '../services/api';\nimport { TriageRequest, Hospital } from '../types';\n\nconst HomePage: React.FC = () => {\n  const navigate = useNavigate();\n\n  // 狀態管理\n  const { latestResult, setLatestResult, clearLatestResult } = useTriageResult();\n  const { nearbyHospitals, setNearbyHospitals, clearNearbyHospitals } = useHospitals();\n  const { isLoading, error, setLoading, setError } = useLoadingState();\n  const { addSymptomHistory } = useSymptomHistory();\n  const { userLocation } = useLocation();\n\n  // 地理位置\n  const {\n    getCurrentLocation,\n    loading: locationLoading,\n    error: locationError\n  } = useGeolocation({\n    onSuccess: (location) => {\n      console.log('Location obtained:', location);\n    },\n    onError: (error) => {\n      console.warn('Location error:', error);\n    }\n  });\n\n  // 處理症狀評估提交\n  const handleSymptomSubmit = useCallback(async (request: TriageRequest) => {\n    setLoading(true);\n    setError(null);\n    clearLatestResult();\n    clearNearbyHospitals();\n\n    try {\n      // 如果需要位置資訊但尚未取得，先嘗試取得位置\n      if (request.include_nearby_hospitals && !request.location && userLocation) {\n        request.location = userLocation;\n      }\n\n      // 執行症狀評估\n      const result = await triageApi.quickTriage(request);\n      setLatestResult(result);\n\n      // 加入歷史記錄\n      addSymptomHistory({\n        symptom_text: request.symptom_text,\n        triage_level: result.triage_level,\n        timestamp: new Date().toISOString(),\n        location: request.location\n      });\n\n      // 如果有附近醫院資料，直接設定\n      if (result.nearby_hospitals) {\n        setNearbyHospitals(result.nearby_hospitals);\n      }\n\n      // 成功提示\n      toast.success('症狀評估完成');\n\n      // 如果是緊急情況，顯示特別提醒\n      if (result.triage_level === 'emergency') {\n        toast.error('檢測到緊急狀況！請立即撥打119', {\n          duration: 10000,\n          position: 'top-center'\n        });\n      }\n\n    } catch (err) {\n      const message = err instanceof Error ? err.message : '評估失敗，請重試';\n      setError(message);\n      toast.error(message);\n      console.error('Triage submission error:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [\n    setLoading,\n    setError,\n    clearLatestResult,\n    clearNearbyHospitals,\n    setLatestResult,\n    addSymptomHistory,\n    setNearbyHospitals,\n    userLocation\n  ]);\n\n  // 處理尋找附近醫院\n  const handleFindHospitals = useCallback(async () => {\n    if (!userLocation) {\n      toast.error('請先允許位置存取');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const hospitals = await hospitalApi.searchNearby({\n        latitude: userLocation.latitude,\n        longitude: userLocation.longitude,\n        radius: 10000, // 10km\n        limit: 20,\n        departments: latestResult?.recommended_departments\n      });\n\n      // 計算距離並排序\n      const hospitalsWithDistance = hospitals.map(hospital => ({\n        ...hospital,\n        distance: locationApi.calculateDistance(\n          userLocation.latitude,\n          userLocation.longitude,\n          hospital.lat,\n          hospital.lng\n        )\n      })).sort((a, b) => a.distance - b.distance);\n\n      setNearbyHospitals(hospitalsWithDistance);\n      toast.success(`找到 ${hospitals.length} 家附近醫院`);\n\n    } catch (err) {\n      const message = err instanceof Error ? err.message : '搜尋醫院失敗';\n      toast.error(message);\n      console.error('Hospital search error:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [userLocation, latestResult?.recommended_departments, setLoading, setNearbyHospitals]);\n\n  // 處理緊急撥號\n  const handleEmergencyCall = useCallback((number: string) => {\n    emergencyApi.call(number);\n\n    // 記錄緊急撥號事件\n    console.log(`Emergency call initiated: ${number}`);\n    toast.success(`正在撥打 ${number}`, {\n      icon: '📞'\n    });\n  }, []);\n\n  // 處理醫院選擇\n  const handleHospitalSelect = useCallback((hospital: Hospital) => {\n    console.log('Hospital selected:', hospital);\n    toast.success(`已選擇：${hospital.name}`);\n  }, []);\n\n  // 處理醫院電話撥打\n  const handleHospitalCall = useCallback((phone: string) => {\n    emergencyApi.call(phone);\n    toast.success(`正在撥打：${phone}`, {\n      icon: '📞'\n    });\n  }, []);\n\n  // 處理醫院導航\n  const handleHospitalNavigate = useCallback((hospital: Hospital) => {\n    const googleMapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${hospital.lat},${hospital.lng}&destination_place_id=${hospital.id}`;\n\n    try {\n      window.open(googleMapsUrl, '_blank');\n      toast.success(`正在開啟導航至：${hospital.name}`);\n    } catch (err) {\n      // 如果無法開啟，複製地址到剪貼簿\n      navigator.clipboard?.writeText(hospital.address);\n      toast.success(`地址已複製：${hospital.address}`);\n    }\n  }, []);\n\n  // 處理位置點擊\n  const handleLocationClick = useCallback(() => {\n    if (locationLoading) return;\n    getCurrentLocation();\n  }, [getCurrentLocation, locationLoading]);\n\n  // 處理歷史記錄點擊\n  const handleHistoryClick = useCallback(() => {\n    navigate('/history');\n  }, [navigate]);\n\n  // 自動取得位置（首次載入）\n  useEffect(() => {\n    if (!userLocation && !locationError) {\n      // 延遲一下再自動取得位置，避免干擾使用者\n      const timer = setTimeout(() => {\n        getCurrentLocation();\n      }, 1000);\n\n      return () => clearTimeout(timer);\n    }\n  }, [userLocation, locationError, getCurrentLocation]);\n\n  return (\n    <div className=\"min-h-screen relative\">\n      {/* 標題列 */}\n      <Header\n        onLocationClick={handleLocationClick}\n        onHistoryClick={handleHistoryClick}\n      />\n\n      {/* 主要內容區域 */}\n      <main className=\"container-glass py-8 space-y-8 relative z-10\">\n        {/* 歡迎區域 */}\n        <section className=\"text-center space-y-4 animate-fade-in\">\n          <div className=\"inline-flex items-center gap-3 glass-card rounded-2xl px-6 py-3\">\n            <div className=\"w-3 h-3 bg-medical-500 rounded-full animate-ping\"></div>\n            <span className=\"text-medical-700 font-medium text-sm\">AI 醫療助手已就緒</span>\n          </div>\n\n          <h2 className=\"text-2xl md:text-3xl font-bold text-gray-800 animate-fade-in animate-delay-200\">\n            描述您的症狀，\n            <span className=\"text-gradient\">立即獲得智能分級</span>\n          </h2>\n\n          <p className=\"text-gray-600 max-w-lg mx-auto leading-relaxed animate-fade-in animate-delay-300\">\n            基於台灣醫療標準的AI分級系統，提供即時症狀評估與就醫建議\n          </p>\n        </section>\n\n        {/* 錯誤訊息 - 現代化版本 */}\n        {error && (\n          <div className=\"emergency-glass rounded-2xl p-6 animate-scale-in\">\n            <div className=\"flex items-start gap-4\">\n              <div className=\"flex-shrink-0 w-10 h-10 bg-red-500 rounded-full flex items-center justify-center\">\n                <svg className=\"w-5 h-5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n                </svg>\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"font-semibold text-red-800 mb-1\">系統提示</h3>\n                <p className=\"text-red-700\">{error}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* 症狀輸入表單 */}\n        <section className=\"animate-fade-in animate-delay-100\">\n          <SymptomForm onSubmit={handleSymptomSubmit} />\n        </section>\n\n        {/* 分級結果 */}\n        {latestResult && (\n          <section className=\"animate-slide-up\">\n            <TriageResult\n              result={latestResult}\n              onFindHospitals={handleFindHospitals}\n              onEmergencyCall={handleEmergencyCall}\n            />\n          </section>\n        )}\n\n        {/* 附近醫院列表 */}\n        {nearbyHospitals.length > 0 && (\n          <section className=\"animate-slide-up animate-delay-200\">\n            <HospitalList\n              hospitals={nearbyHospitals}\n              userLocation={userLocation}\n              loading={isLoading}\n              onHospitalSelect={handleHospitalSelect}\n              onCallHospital={handleHospitalCall}\n              onNavigate={handleHospitalNavigate}\n            />\n          </section>\n        )}\n\n        {/* 現代化載入狀態 */}\n        {isLoading && !latestResult && (\n          <div className=\"flex flex-col items-center justify-center py-12 animate-fade-in\">\n            <div className=\"glass-card rounded-3xl p-8 text-center space-y-4\">\n              <div className=\"loading-modern mx-auto\"></div>\n              <div className=\"space-y-2\">\n                <h3 className=\"text-lg font-semibold text-gray-800\">AI 正在分析您的症狀</h3>\n                <p className=\"text-gray-600 text-sm\">\n                  運用深度學習模型進行醫療級評估...\n                </p>\n              </div>\n              <div className=\"flex justify-center space-x-1\">\n                <div className=\"w-2 h-2 bg-brand-400 rounded-full animate-bounce\"></div>\n                <div className=\"w-2 h-2 bg-brand-400 rounded-full animate-bounce animate-delay-75\"></div>\n                <div className=\"w-2 h-2 bg-brand-400 rounded-full animate-bounce animate-delay-150\"></div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* 功能介紹區域 (當沒有評估結果時顯示) */}\n        {!latestResult && !isLoading && (\n          <section className=\"grid md:grid-cols-3 gap-6 animate-fade-in animate-delay-500\">\n            <div className=\"glass-card rounded-2xl p-6 text-center space-y-3 hover:scale-105 transition-all duration-300\">\n              <div className=\"w-12 h-12 bg-gradient-brand rounded-xl mx-auto flex items-center justify-center\">\n                <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n                </svg>\n              </div>\n              <h3 className=\"font-semibold text-gray-800\">智能分級</h3>\n              <p className=\"text-sm text-gray-600 leading-relaxed\">\n                AI 分析症狀嚴重程度，提供標準化醫療分級建議\n              </p>\n            </div>\n\n            <div className=\"glass-card rounded-2xl p-6 text-center space-y-3 hover:scale-105 transition-all duration-300\">\n              <div className=\"w-12 h-12 bg-gradient-accent rounded-xl mx-auto flex items-center justify-center\">\n                <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" />\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\n                </svg>\n              </div>\n              <h3 className=\"font-semibold text-gray-800\">就近就醫</h3>\n              <p className=\"text-sm text-gray-600 leading-relaxed\">\n                即時定位附近醫療院所，提供距離與科別資訊\n              </p>\n            </div>\n\n            <div className=\"glass-card rounded-2xl p-6 text-center space-y-3 hover:scale-105 transition-all duration-300\">\n              <div className=\"w-12 h-12 bg-gradient-to-br from-medical-400 to-medical-600 rounded-xl mx-auto flex items-center justify-center\">\n                <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n                </svg>\n              </div>\n              <h3 className=\"font-semibold text-gray-800\">隱私保護</h3>\n              <p className=\"text-sm text-gray-600 leading-relaxed\">\n                符合 PDPA 規範，不儲存個人資料，僅供即時評估\n              </p>\n            </div>\n          </section>\n        )}\n      </main>\n\n      {/* 底部安全區域 */}\n      <div className=\"safe-bottom\"></div>\n    </div>\n  );\n};\n\nexport default HomePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}